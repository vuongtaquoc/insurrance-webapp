<div class="page-container">
  <nz-spin [nzSpinning]="isSpinning">
    <div class="page-company" [ngClass]="{'page-declarations-hide-last-tab': !usedocumentDT01}" cardFullHeight>
      <nz-tabset nzSize="small" nzTabPosition="bottom" nzSelectedIndex="1" [nzTabBarExtraContent]="extraTemplate" (nzSelectChange)="handleSelectTab($event)">
        <nz-tab nzTitle="Danh mục tài liệu">
          <div class="page-document-list__container">
            <form nz-form [formGroup]="documentForm">
              <h1><strong>600</strong> | Báo tăng lao động</h1>
              <div nz-row [nzGutter]="10">
                <div nz-col [nzSpan]="12">
                  <nz-form-item>
                    <nz-form-label class="text-left" [nzRequired]="true" [nzSpan]="10">Người nộp</nz-form-label>
                    <nz-form-control [nzSpan]="14">
                      <input nz-input
                        placeholder="Người nộp"
                        formControlName="userAction"
                        (onChange)="handleChangeForm()"
                      />
                    </nz-form-control>
                  </nz-form-item>
                </div>
                <div nz-col [nzSpan]="12">
                    <nz-form-item>
                      <nz-form-label class="text-left" [nzRequired]="true" [nzSpan]="10">Số điện thoại</nz-form-label>
                      <nz-form-control [nzSpan]="14">
                        <input nz-input
                          placeholder="Số điện thoại"
                          formControlName="mobile"
                          (onChange)="handleChangeForm()"
                        />
                      </nz-form-control>
                    </nz-form-item>
                  </div>
                </div>
                <h1>Thành phần hồ sơ</h1>
                <div class="document-form__process-table">
                  <div class="document-form__process-table">
                    <app-document-table
                      [data]="documentList"
                      (onChange)="handleChangeProcessTable($event)"
                      (onDelete)="handleDeleteProcessData($event)"
                    ></app-document-table>
                  </div>
                </div>
                <div nz-row [nzGutter]="10">
                  <div nz-col [nzSpan]="12">
                    <nz-form-item>
                      <label nz-checkbox  formControlName="usedocumentDT01">Phát sinh kê khai Mẫu D01T-TS Bảng kê thông tin</label>
                    </nz-form-item>
                  </div>
                </div>
            </form>
          </div><!-- page-declarations__container -->
        </nz-tab><!-- tab 1-->
        <nz-tab nzTitle="KT3-TS">
          <div class="page-company__container">
            <div>&nbsp;</div>
            <div class="page-company__content">
              <div class="page-company__editor">
                <form  nz-form [formGroup]="companyForm" (ngSubmit)="handleSubmit()" class="login-page">
                  <div class="page-container">    
                      
                        <div class="page-company__blank"></div>
                        <div class="page-company__main">
                          <h1>A. Thông tin đơn vị</h1> 
                          <div nz-row nzGutter="8">
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.city' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="6">
                                <nz-form-control
                                  [nzSpan]="24"
                                >
                                  <nz-select formControlName="cityId" (ngModelChange)="changeCity($event);"  nzAllowClear nzPlaceHolder="Lựa chọn">
                                    <nz-option [nzValue]="city.id" [nzLabel]="city.name" *ngFor="let city of cities"></nz-option>
                                  </nz-select>
                                </nz-form-control>
                              </div>
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black text-padding-left" [nzSpan]="24">{{ 'company.from.insurranceManagement' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="6">
                                <nz-form-control
                                  [nzSpan]="24"
                                >
                                  <nz-select formControlName="isurranceDepartmentId" nzAllowClear nzPlaceHolder="Lựa chọn">
                                    <nz-option [nzValue]="isurranceDepartment.id" [nzLabel]="isurranceDepartment.name" *ngFor="let isurranceDepartment of isurranceDepartments"></nz-option>
                                  </nz-select>
                                </nz-form-control>
                              </div>
                          </div>
                
                          <div nz-row nzGutter="8">
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.companyCode' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="6">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                <input formControlName="code" class="ant-input" placeholder="Nhập dữ liệu" />
                                </nz-form-control>
                              </div>
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black text-padding-left" [nzSpan]="24">{{ 'company.from.area' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="6">
                                <nz-form-control
                                  [nzSpan]="24"
                                >
                                  <nz-select formControlName="salaryAreaId"  nzAllowClear nzPlaceHolder="Lựa chọn">
                                    <nz-option [nzValue]="salaryArea.id" [nzLabel]="salaryArea.name" *ngFor="let salaryArea of salaryAreas"></nz-option>
                                  </nz-select>
                                </nz-form-control>
                              </div>
                          </div>
                
                          <div nz-row nzGutter="8">
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.name' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="18">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                <input formControlName="name" class="ant-input" placeholder="Nhập dữ liệu" />
                                </nz-form-control>
                              </div>
                          </div>
                
                          <div nz-row nzGutter="8">
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.addressRegister' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="18">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                <input formControlName="addressRegister" class="ant-input" placeholder="Nhập dữ liệu"/>
                                </nz-form-control>
                              </div>
                          </div>
                
                          <div nz-row nzGutter="8">
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.address' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="18">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                <input formControlName="address" class="ant-input" placeholder="Nhập dữ liệu" />
                                </nz-form-control>
                              </div>
                          </div>
                
                          <div nz-row nzGutter="8">
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.taxCode' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="6">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                <input formControlName="taxCode" class="ant-input" placeholder="Nhập dữ liệu" [(ngModel)]="taxCode" />
                                </nz-form-control>
                              </div>
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black text-padding-left" [nzSpan]="24">{{ 'company.from.delegate' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="6">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                <input formControlName="delegate" class="ant-input"  placeholder="Nhập dữ liệu" />
                                </nz-form-control>
                              </div>
                          </div>
                
                          <div nz-row nzGutter="8">
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.traders' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="6">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                <input formControlName="traders" class="ant-input" placeholder="Nhập dữ liệu" />
                                </nz-form-control>
                              </div>
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black text-padding-left" [nzSpan]="24">{{ 'company.from.mobile' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="6">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                <input formControlName="mobile" class="ant-input"  placeholder="Nhập dữ liệu" />
                                </nz-form-control>
                              </div>
                          </div>
                
                          <div nz-row nzGutter="8">
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.emailContract' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="18">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                <input formControlName="emailOfContract" class="ant-input" placeholder="Nhập dữ liệu" />
                                </nz-form-control>
                              </div>
                          </div>
                
                          <div nz-row nzGutter="8">
                              <div nz-col nzMd="6">
                                  <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.methodPay' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="6">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                  <nz-select formControlName="paymentMethodId" nzAllowClear  nzPlaceHolder="Lựa chọn">
                                    <nz-option [nzValue]="paymentMethod.id" [nzLabel]="paymentMethod.name" *ngFor="let paymentMethod of paymentMethods"></nz-option>
                                  </nz-select>
                                </nz-form-control>
                              </div>
                              <div nz-col nzMd="5">
                                  <nz-form-label class="black text-padding-left" [nzSpan]="24">{{ 'company.from.responseResults' | translate }} <span class="required">*</span></nz-form-label>
                              </div>
                              <div nz-col nzMd="7">
                                  <nz-form-control
                                  [nzSpan]="24"
                                >
                                  <nz-radio-group formControlName="responseResults">
                                    <label nz-radio nzValue="1">Nhận tại CQBH</label>
                                    <label nz-radio nzValue="2">Nhận qua BĐ</label>
                                  </nz-radio-group>
                                </nz-form-control>
                              </div>
                          </div>
                
                          <div nz-row nzGutter="8">
                              <div nz-col nzMd="24">
                                  <nz-form-label class="black" [nzSpan]="24">Đơn vị cam kết hoàn toàn chịu trách nhiệm trước pháp luật về tính chính xác, trung thực của nội dung trên.</nz-form-label>
                              </div>
                          </div>
                
                        <h1>B. Cấu hình kê khai {{ companyForm.get('groupCompanyCode').value || 'note'}}</h1>
                        
                        <div nz-row nzGutter="8">
                            <div nz-col nzMd="6">
                                <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.group' | translate }} <span class="required">*</span></nz-form-label>
                            </div>
                            <div nz-col nzMd="18">
                                <nz-form-control
                                  [nzSpan]="24"
                                >
                                  <nz-select formControlName="groupCompanyCode" nzAllowClear  nzPlaceHolder="Lựa chọn">
                                    <nz-option [nzValue]="groupCompany.code" [nzLabel]="groupCompany.name" *ngFor="let groupCompany of groupCompanies"></nz-option>
                                  </nz-select>
                                </nz-form-control>
                            </div>
                        </div>
                
                        <div nz-row nzGutter="8">
                            <div nz-col nzMd="6">
                                <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.submission' | translate }} <span class="required">*</span></nz-form-label>
                            </div>
                            <div nz-col nzMd="18">
                                <nz-form-control
                                  [nzSpan]="24"
                                >
                                  <nz-radio-group formControlName="submissionType">
                                    <label nz-radio nzValue="0">Ký và nộp luôn</label>
                                    <label nz-radio nzValue="1">Phải trình ký</label>
                                  </nz-radio-group>
                                </nz-form-control>
                            </div>
                        </div>
                
                        <div nz-row nzGutter="8" *ngIf="(companyForm.get('groupCompanyCode').value === '02' || companyForm.get('groupCompanyCode').value === '04' || companyForm.get('groupCompanyCode').value === '05')">
                            <div nz-col nzMd="6">
                                <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.district' | translate }} <span class="required">*</span></nz-form-label>
                            </div>
                            <div nz-col nzMd="6">
                              <nz-form-control
                                [nzSpan]="24"
                              >
                                <nz-select formControlName="districtId" (ngModelChange)="changeDistrict($event);" nzAllowClear nzPlaceHolder="Lựa chọn">
                                  <nz-option [nzValue]="district.id" [nzLabel]="district.name" *ngFor="let district of districts"></nz-option>
                                </nz-select>
                              </nz-form-control>
                            </div>
                            <div nz-col nzMd="6" *ngIf="(companyForm.get('groupCompanyCode').value === '02' || companyForm.get('groupCompanyCode').value === '05')">
                                <nz-form-label class="black text-padding-left" [nzSpan]="24">{{ 'company.from.wards' | translate }} <span class="required">*</span></nz-form-label>
                            </div>
                            <div nz-col nzMd="6" *ngIf="(companyForm.get('groupCompanyCode').value === '02' || companyForm.get('groupCompanyCode').value === '05')">
                              <nz-form-control
                                [nzSpan]="24"
                              >
                                <nz-select formControlName="wardsId" nzAllowClear nzPlaceHolder="Lựa chọn">
                                  <nz-option [nzValue]="ward.id" [nzLabel]="ward.name" *ngFor="let ward of wards"></nz-option>
                                </nz-select>
                              </nz-form-control>
                            </div>
                        </div>
                
                        <div nz-row nzGutter="8" *ngIf="(companyForm.get('groupCompanyCode').value == '03')">
                            <div nz-col nzMd="6">
                                <nz-form-label class="black" [nzSpan]="24">{{ 'company.from.object' | translate }} <span class="required">*</span></nz-form-label>
                            </div>
                            <div nz-col nzMd="18">
                                <nz-form-control
                                  [nzSpan]="24"
                                >
                                  <nz-radio-group formControlName="object">
                                    <label nz-radio nzValue="1">{{ 'company.from.studentLevelOne' | translate }}</label>
                                    <label nz-radio nzValue="2">{{ 'company.from.studentLevelTwo' | translate }}</label>
                                  </nz-radio-group>
                                </nz-form-control>
                            </div>
                        </div>
                
                        <div nz-row nzGutter="8" *ngIf="(companyForm.get('groupCompanyCode').value == '01')">
                            <div nz-col nzMd="24">
                                <nz-form-label class="black" [nzSpan]="24">Danh sách phòng ban</nz-form-label>
                            </div>
                            <div nz-col nzMd="24">
                                <div class="page-declarations__editor">
                                    <app-table-editor
                                      [headers]="tableHeader"
                                      [columns]="tableColumnType"
                                      [columnWidths]="tableColumnWidth"
                                      [data]="department"
                                    ></app-table-editor>
                                  </div><!-- page-declarations__editor -->
                            </div>
                        </div>
                      </div>
                  </div>
                </form>
              </div><!-- page-declarations__editor -->

              <nz-collapse [nzBordered]="false">
                <nz-collapse-panel class="collapse-attachment" [nzHeader]="attachmentHeader" [nzActive]="panel.attachment.active" (nzActiveChange)="collapseChange($event, 'attachment')">
                    <app-labor-attachment  [files]="files" [declarationCode] = "'6000'" (onSelectedFileChanged)="handleFileSelected($event)"></app-labor-attachment>
                </nz-collapse-panel>
              </nz-collapse>
              <ng-template #attachmentHeader>
                Tài liệu kèm theo <span class="collapse-attachment-note">(tổng dung lượng &lt; 20MB)</span>
              </ng-template>
            </div><!-- page-declarations__content -->
          </div><!-- page-declarations__container -->
        </nz-tab><!-- tab 2 -->
      </nz-tabset>
      <ng-template #extraTemplate>
        <div class="page-declarations__footer">
          <button nz-button class="page-declarations__footer-export" nzType="default" nzSize="small" (click)="emitEventToChild('saveAndView')">
            <i nz-icon nzType="upload"></i>Xuất tờ khai
          </button>
          <button nz-button nzType="default" nzSize="small" (click)="emitEventToChild('save')">
            <i nz-icon nzType="save"></i>Ghi lại
          </button>
          <button nz-button class="page-declarations__footer-button" nzType="default" nzSize="small" (click)="emitEventToChild('back')">
            <i nz-icon nzType="reload"></i>Quay lại
          </button>
        </div>
      </ng-template>
    </div>
  </nz-spin>
</div>
